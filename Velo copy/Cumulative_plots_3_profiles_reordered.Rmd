---
title: "percentage_analysis_histogram"
author: "Jeremy Briand"
date: "28/09/2021"
output: html_document
---

Importer les librairies

```{r}
library(easypackages)
packages("dplyr", "tidyr", "readr", "readxl", "plot3D", "plot3Drgl", "hms", "plotly", "htmlwidgets")
library(arules)
```

Importer les jeux de données



```{r}

skiba <- read_csv("seances_purdy/skiba_percent_perf.csv")
coggan <- read_csv("seances_purdy/coggan_percent_perf.csv")

sprinter_skiba <- read_csv( "seances_purdy/sprinter_skiba_percent_perf.csv")
pursuiter_skiba <- read_csv( "seances_purdy/pursuiter_skiba_percent_perf.csv")
time_trialist_skiba <- read_csv( "seances_purdy/time_trialist_skiba_percent_perf.csv")
all_around_skiba <- read_csv( "seances_purdy/all_around_skiba_percent_perf.csv")
sprinter_coggan <- read_csv( "seances_purdy/sprinter_coggan_percent_perf.csv")
pursuiter_coggan <- read_csv( "seances_purdy/pursuiter_coggan_percent_perf.csv")
time_trialist_coggan <-read_csv("seances_purdy/time_trialist_coggan_percent_perf.csv")
all_around_coggan <- read_csv("seances_purdy/all_around_coggan_percent_perf.csv")


```

Calculer le pourcentage de séances impossibles selon le modèle et le profil

```{r}

#sprinter coggan
imp_sprinter_coggan <- sprinter_coggan %>%
  filter(percent_power_max > 100)

percent_imp_sprinter_coggan <-  length(imp_sprinter_coggan$Nrep)/length(sprinter_coggan$Nrep) *100


#pursuiter coggan

imp_pursuiter_coggan <- pursuiter_coggan %>%
  filter(percent_power_max > 100)

percent_imp_pursuiter_coggan <-  length(imp_pursuiter_coggan$Nrep)/length(pursuiter_coggan$Nrep) *100

#time_trialist coggan

imp_time_trialist_coggan <- time_trialist_coggan %>%
  filter(percent_power_max > 100)

percent_imp_time_trialist_coggan <-  length(imp_time_trialist_coggan$Nrep)/length(time_trialist_coggan$Nrep) *100

#All around coggan

imp_all_around_coggan <- all_around_coggan %>%
  filter(percent_power_max > 100)

percent_imp_all_around_coggan <-  length(imp_all_around_coggan$Nrep)/length(all_around_coggan$Nrep) *100


#sprinter skiba
imp_sprinter_skiba <- sprinter_skiba %>%
  filter(percent_power_max > 100)

percent_imp_sprinter_skiba <-  length(imp_sprinter_skiba$Nrep)/length(sprinter_skiba$Nrep) *100


#pursuiter skiba

imp_pursuiter_skiba <- pursuiter_skiba %>%
  filter(percent_power_max > 100)

percent_imp_pursuiter_skiba <-  length(imp_pursuiter_skiba$Nrep)/length(pursuiter_skiba$Nrep) *100

#time_trialist skiba

imp_time_trialist_skiba <- time_trialist_skiba %>%
  filter(percent_power_max > 100)

percent_imp_time_trialist_skiba <-  length(imp_time_trialist_skiba$Nrep)/length(time_trialist_skiba$Nrep) *100

#All around skiba

imp_all_around_skiba <- all_around_skiba %>%
  filter(percent_power_max > 100)

percent_imp_all_around_skiba <-  length(imp_all_around_skiba$Nrep)/length(all_around_skiba$Nrep) *100



#créer un data frame pour un tableau

percentage_impossible <- data.frame(sprinter_coggan = percent_imp_sprinter_coggan,
                                    pursuiter_coggan = percent_imp_pursuiter_coggan,
                                    time_trialist_coggan = percent_imp_time_trialist_coggan,
                                    sall_around_coggan = percent_imp_all_around_coggan,
                                    sprinter_skiba = percent_imp_sprinter_skiba,
                                    pursuiter_skiba = percent_imp_pursuiter_skiba,
                                    time_trialist_skiba = percent_imp_time_trialist_skiba,
                                    all_around_skiba = percent_imp_all_around_skiba
                             )


```

Histo plot intensity
Graphique qui calcule le pourcentage oulla probabilité qu'une séance soit impossible dans un interval d'intensité donnée.

```{r}
#valeur minimale Coggan

min_coggan <- min(coggan$percent_PAM)

#Valeur maximale Coggan
max_coggan <- max(coggan$percent_PAM)

#vecteur d'intensités possible en pourcentage de la PAM

intensity <- seq(min_coggan, max_coggan, 15)

#Isoler un profil et calculer le nombre de séances pour une valeur égale ou supérieure en intensité

#Sprinter

coggan_sprint <- coggan %>%
  filter(profil == "sprinter")


cumulative_percent <- c()
for (i in intensity){
  imp_sub <- coggan_sprint %>%
    filter(percent_PAM > i-30,
           percent_PAM <= i+30,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_sprint %>%
    filter(percent_PAM > i-30,
           percent_PAM <= i+30)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

sprint <- data.frame(Profile = "sprinter",
                     intensity = intensity,
                     cumulative_percent = cumulative_percent)

#Pursuiter

# coggan_pursuit <- coggan %>%
#   filter(profil == "pursuiter")
# 
# 
# cumulative_percent <- c()
# for (i in intensity){
#   imp_sub <- coggan_pursuit %>%
#     filter(percent_PAM > i-30,
#            percent_PAM <= i+30,
#            percent_power_max > 100)
#   
#   imp_sub_count <- length(imp_sub$Nrep)
#   
#  tot <- coggan_pursuit %>%
#     filter(percent_PAM > i-30,
#            percent_PAM <= i+30)
#   
#  tot_count <- length(tot$Nrep)
#   
#   percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
#   
#   cumulative_percent <- c(cumulative_percent, percent_imp)
#   
# }
# 
# pursuit <- data.frame(Profile = "pursuiter",
#                      intensity = intensity,
#                      cumulative_percent = cumulative_percent)


#time trialist
coggan_tt <- coggan %>%
  filter(profil == "time-trialist")


cumulative_percent <- c()
for (i in intensity){
  imp_sub <- coggan_tt %>%
    filter(percent_PAM > i-30,
           percent_PAM <= i+30,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_tt %>%
    filter(percent_PAM > i-30,
           percent_PAM <= i+30)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

tt <- data.frame(Profile = "time-trialist",
                     intensity = intensity,
                     cumulative_percent = cumulative_percent)

#all around

coggan_aa <- coggan %>%
  filter(profil == "all around")

cumulative_percent <- c()
for (i in intensity){
  imp_sub <- coggan_aa %>%
    filter(percent_PAM > i-30,
           percent_PAM <= i+30,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_aa %>%
    filter(percent_PAM > i-30,
           percent_PAM <= i+30)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

aa <- data.frame(Profile = "all around",
                     intensity = intensity,
                     cumulative_percent = cumulative_percent)

#Joindre les 4 profils ensemble

coggan_cumu <- bind_rows(sprint,  tt, aa)

#renommer les facteurs
coggan_cumu$Profile <- factor(coggan_cumu$Profile, levels = c("time-trialist", "all around",  'sprinter'), labels = c("Time-trialist",  "All rounder", "Sprinter"))


#définir le type de ligne
linetype <- c()
for(i in 1:length(coggan_cumu$Profile)){

 if(coggan_cumu$Profile[i] == "Sprinter"){t <- "solid"}
if(coggan_cumu$Profile[i] == "Time-trialist"){t <- "dotted"}
if(coggan_cumu$Profile[i] == "All rounder"){t <- "twodash"}
linetype <- c(linetype, t)
}

linetype <- data.frame(linetype =linetype)

coggan_cumu <- bind_cols(coggan_cumu, linetype)

gci <- ggplot(data = coggan_cumu, aes(x= intensity, y = cumulative_percent))+geom_line(aes(linetype = Profile))+xlab("Intensity (percentage of MAP)") + ylab("% impossible sessions")+theme_classic()+
scale_x_continuous( limits = c(min_coggan, 300), breaks = seq(0, 300, 50))+
  scale_linetype_manual(values = unique(coggan_cumu$linetype))+
  geom_hline(yintercept=30, linetype="solid", color = "blue", size = 0.5)

  

```


Cumulative plot intensity
Graphique qui calcule le pourcentage ou lla probabilité qu'une séance soit impossible si elle est plus grande qu'une valeur d'intensité donnée.


```{r}


#valeur minimale skiba

min_skiba <- min(skiba$percent_PAM)

#Valeur maximale skiba
max_skiba <- max(skiba$percent_PAM)

#vecteur d'intensités possible en pourcentage de la PAM

intensity <- seq(min_skiba, max_skiba, 20)

#Isoler un profil et calculer le nombre de séances pour une valeur égale ou supérieure en intensité

#Sprinter

skiba_sprint <- skiba %>%
  filter(profil == "sprinter")


cumulative_percent <- c()
for (i in intensity){
  imp_sub <- skiba_sprint %>%
    filter(percent_PAM > i-20,
           percent_PAM <= i+40,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_sprint %>%
    filter(percent_PAM > i-20,
           percent_PAM <= i+40)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

sprint <- data.frame(Profile = "Sprinter",
                     intensity = intensity,
                     cumulative_percent = cumulative_percent)

#Pursuiter

# skiba_pursuit <- skiba %>%
#   filter(profil == "pursuiter")
# 
# 
# cumulative_percent <- c()
# for (i in intensity){
#   imp_sub <- skiba_pursuit %>%
#     filter(percent_PAM > i-20,
#            percent_PAM <= i+40,
#            percent_power_max > 100)
#   
#   imp_sub_count <- length(imp_sub$Nrep)
#   
#  tot <- skiba_pursuit %>%
#     filter(percent_PAM > i-20,
#            percent_PAM <= i+40)
#   
#  tot_count <- length(tot$Nrep)
#   
#   percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
#   
#   cumulative_percent <- c(cumulative_percent, percent_imp)
#   
# }
# 
# pursuit <- data.frame(Profile = "pursuiter",
#                      intensity = intensity,
#                      cumulative_percent = cumulative_percent)
# 

#time trialist
skiba_tt <- skiba %>%
  filter(profil == "time trialist")


cumulative_percent <- c()
for (i in intensity){
  imp_sub <- skiba_tt %>%
    filter(percent_PAM > i-20,
           percent_PAM <= i+40,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_tt %>%
    filter(percent_PAM > i-20,
           percent_PAM <= i+40)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

tt <- data.frame(Profile = "Time-trialist",
                     intensity = intensity,
                     cumulative_percent = cumulative_percent)

#all around

skiba_aa <- skiba %>%
  filter(profil == "all around")

cumulative_percent <- c()
for (i in intensity){
  imp_sub <- skiba_aa %>%
    filter(percent_PAM > i-20,
           percent_PAM <= i+40,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_aa %>%
    filter(percent_PAM > i-20,
           percent_PAM <= i+40)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

aa <- data.frame(Profile = "All rounder",
                     intensity = intensity,
                     cumulative_percent = cumulative_percent)

#Joindre les 4 profils ensemble

skiba_cumu <- bind_rows(sprint, tt, aa)

#renommer les facteurs
skiba_cumu$Profile <- factor(skiba_cumu$Profile, levels = c("Time-trialist", "All rounder",  'Sprinter'), labels = c("Time-trialist",  "All rounder", "Sprinter"))

#définir le type de ligne
linetype <- c()
for(i in 1:length(skiba_cumu$Profile)){

 if(skiba_cumu$Profile[i] == "Sprinter"){t <- "solid"}
if(skiba_cumu$Profile[i] == "Time-trialist"){t <- "dotted"}
if(skiba_cumu$Profile[i] == "All rounder"){t <- "twodash"}
linetype <- c(linetype, t)
}

linetype <- data.frame(linetype = linetype)

skiba_cumu <- bind_cols(skiba_cumu, linetype)



gsi <- ggplot(data = skiba_cumu, aes(x= intensity, y = cumulative_percent))+geom_line(aes(linetype = Profile) )+xlab("Intensity (percentage of MAP)") + ylab("% impossible sessions")+theme_classic()+scale_x_continuous( limits = c(min_skiba, 300), breaks = seq(0, 300, 50))+
   scale_linetype_manual(values = unique(skiba_cumu$linetype))+
  geom_hline(yintercept=30, linetype="solid", color = "blue", size = 0.5)

```

Cumulative plot interval duration
Graphique qui calcule le pourcentage ou la probabilité qu'une séance soit impossible si elle est plus grande qu'une valeur de durée d'intervalle donnée.

```{r}
#valeur minimale Coggan

min_coggan <- min(coggan$interval_duration)

#Valeur maximale Coggan
max_coggan <- max(coggan$interval_duration)

#vecteur d'intensités possible en pourcentage de la PAM

interval_duration <- seq(15, 300, 15)

#Isoler un profil et calculer le nombre de séances pour une valeur égale ou supérieure en intensité

#Sprinter

coggan_sprint <- coggan %>%
  filter(profil == "sprinter")


cumulative_percent <- c()
for (i in interval_duration){
  imp_sub <- coggan_sprint %>%
    filter(interval_duration == i,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_sprint %>%
    filter(interval_duration == i)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

sprint <- data.frame(Profile = "sprinter",
                     interval_duration = interval_duration,
                     cumulative_percent = cumulative_percent)

#Pursuiter
# 
# coggan_pursuit <- coggan %>%
#   filter(profil == "pursuiter")
# 
# 
# cumulative_percent <- c()
# for (i in interval_duration){
#   imp_sub <- coggan_pursuit %>%
#     filter(interval_duration == i,
#            percent_power_max > 100)
#   
#   imp_sub_count <- length(imp_sub$Nrep)
#   
#  tot <- coggan_pursuit %>%
#     filter(interval_duration == i)
#   
#  tot_count <- length(tot$Nrep)
#   
#   percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
#   
#   cumulative_percent <- c(cumulative_percent, percent_imp)
#   
# }
# 
# pursuit <- data.frame(Profile = "pursuiter",
#                      interval_duration = interval_duration,
#                      cumulative_percent = cumulative_percent)
# 

#time trialist
coggan_tt <- coggan %>%
  filter(profil == "time-trialist")


cumulative_percent <- c()
for (i in interval_duration){
  imp_sub <- coggan_tt %>%
    filter(interval_duration == i,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_tt %>%
    filter(interval_duration == i)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

tt <- data.frame(Profile = "time-trialist",
                     interval_duration = interval_duration,
                     cumulative_percent = cumulative_percent)

#all around

coggan_aa <- coggan %>%
  filter(profil == "all around")

cumulative_percent <- c()
for (i in interval_duration){
  imp_sub <- coggan_aa %>%
    filter(interval_duration == i,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_aa %>%
    filter(interval_duration == i)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

aa <- data.frame(Profile = "all around",
                     interval_duration = interval_duration,
                     cumulative_percent = cumulative_percent)

#Joindre les 4 profils ensemble

coggan_cumu <- bind_rows(sprint,  tt, aa)

#renommer les facteurs
coggan_cumu$Profile <- factor(coggan_cumu$Profile, levels = c("time-trialist", "all around",  'sprinter'), labels = c("Time-trialist",  "All rounder", "Sprinter"))

#définir le type de ligne
linetype <- c()
for(i in 1:length(coggan_cumu$Profile)){

 if(coggan_cumu$Profile[i] == "Sprinter"){t <- "solid"}
if(coggan_cumu$Profile[i] == "Time-trialist"){t <- "dotted"}
if(coggan_cumu$Profile[i] == "All rounder"){t <- "twodash"}
linetype <- c(linetype, t)
}

linetype <- data.frame(linetype = linetype)

coggan_cumu <- bind_cols(coggan_cumu, linetype)

#Faire le graph

gcint <- ggplot(data = coggan_cumu, aes(x= interval_duration, y = cumulative_percent))+geom_line(aes(linetype = Profile))+xlab("Interval duration (s)") + ylab("% impossible sessions")+theme_classic()+
  scale_x_continuous( limits = c(min_coggan, 150), breaks = seq(0, 300, 30)) +theme(legend.position = c(0.5, 0.5))+
   scale_linetype_manual(values = unique(coggan_cumu$linetype))+
  geom_hline(yintercept=30, linetype="solid", color = "blue", size = 0.5)

```

Cumulative plot intensity
Graphique qui calcule le pourcentage ou la probabilité qu'une séance soit impossible si elle est plus grande qu'une valeur de durée d'intervalle donnée.

```{r}


#valeur minimale skiba

min_skiba <- min(skiba$interval_duration)

#Valeur maximale skiba
max_skiba <- max(skiba$interval_duration)

#vecteur d'intensités possible en pourcentage de la PAM

interval_duration <- seq(15, 300, 15)

#Isoler un profil et calculer le nombre de séances pour une valeur égale ou supérieure en intensité

#Sprinter

skiba_sprint <- skiba %>%
  filter(profil == "sprinter")


cumulative_percent <- c()
for (i in interval_duration){
  imp_sub <- skiba_sprint %>%
    filter(interval_duration == i,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_sprint %>%
    filter(interval_duration == i)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

sprint <- data.frame(Profile = "sprinter",
                     interval_duration = interval_duration,
                     cumulative_percent = cumulative_percent)

#Pursuiter

# skiba_pursuit <- skiba %>%
#   filter(profil == "pursuiter")
# 
# 
# cumulative_percent <- c()
# for (i in interval_duration){
#   imp_sub <- skiba_pursuit %>%
#     filter(interval_duration == i,
#            percent_power_max > 100)
#   
#   imp_sub_count <- length(imp_sub$Nrep)
#   
#  tot <- skiba_pursuit %>%
#     filter(interval_duration == i)
#   
#  tot_count <- length(tot$Nrep)
#   
#   percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
#   
#   cumulative_percent <- c(cumulative_percent, percent_imp)
#   
# }
# 
# pursuit <- data.frame(Profile = "pursuiter",
#                      interval_duration = interval_duration,
#                      cumulative_percent = cumulative_percent)


#time trialist
skiba_tt <- skiba %>%
  filter(profil == "time trialist")


cumulative_percent <- c()
for (i in interval_duration){
  imp_sub <- skiba_tt %>%
    filter(interval_duration == i,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_tt %>%
    filter(interval_duration == i)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

tt <- data.frame(Profile = "time-trialist",
                     interval_duration = interval_duration,
                     cumulative_percent = cumulative_percent)

#all around

skiba_aa <- skiba %>%
  filter(profil == "all around")

cumulative_percent <- c()
for (i in interval_duration){
  imp_sub <- skiba_aa %>%
    filter(interval_duration == i,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_aa %>%
    filter(interval_duration == i)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

aa <- data.frame(Profile = "all around",
                     interval_duration = interval_duration,
                     cumulative_percent = cumulative_percent)

#Joindre les 4 profils ensemble

skiba_cumu <- bind_rows(sprint,  tt, aa)

#renommer les facteurs
skiba_cumu$Profile <- factor(skiba_cumu$Profile, levels = c("time-trialist", "all around",  'sprinter'), labels = c("Time-trialist",  "All rounder", "Sprinter"))

#définir le type de ligne
linetype <- c()
for(i in 1:length(skiba_cumu$Profile)){

 if(skiba_cumu$Profile[i] == "Sprinter"){t <- "solid"}
if(skiba_cumu$Profile[i] == "Time-trialist"){t <- "dotted"}
if(skiba_cumu$Profile[i] == "All rounder"){t <- "twodash"}
linetype <- c(linetype, t)
}

linetype <- data.frame(linetype = linetype)

skiba_cumu <- bind_cols(skiba_cumu, linetype)

#graph

gsint <- ggplot(data = skiba_cumu, aes(x= interval_duration, y = cumulative_percent))+geom_line(aes(linetype = Profile))+xlab("Interval duration (s)") + ylab("% impossible sessions")+theme_classic()+ 
  scale_x_continuous( limits = c(min_skiba, 240), breaks = seq(0, 300, 30)) +theme(legend.position = c(0.5, 0.8))+
   scale_linetype_manual(values = unique(skiba_cumu$linetype))+
  geom_hline(yintercept=30, linetype="solid", color = "blue", size = 0.5)

```

Cumulative plot Nrep
Graphique qui calcule le pourcentage ou la probabilité qu'une séance soit impossible si elle est plus grande qu'une valeur de durée d'intervalle donnée.

```{r}
#valeur minimale Coggan

min_coggan <- min(coggan$Nrep)

#Valeur maximale Coggan
max_coggan <- max(coggan$Nrep)

#vecteur d'intensités possible en pourcentage de la PAM

nrep <- seq(2, 20, 2)

#Isoler un profil et calculer le nombre de séances pour une valeur égale ou supérieure en intensité

#Sprinter

coggan_sprint <- coggan %>%
  filter(profil == "sprinter")


cumulative_percent <- c()
for (i in nrep){
  imp_sub <- coggan_sprint %>%
    filter(Nrep == i,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_sprint %>%
    filter(Nrep == i)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

sprint <- data.frame(Profile = "sprinter",
                     nrep = nrep,
                     cumulative_percent = cumulative_percent)

#Pursuiter

# coggan_pursuit <- coggan %>%
#   filter(profil == "pursuiter")
# 
# 
# cumulative_percent <- c()
# for (i in nrep){
#   imp_sub <- coggan_pursuit %>%
#     filter(Nrep == i,
#            percent_power_max > 100)
#   
#   imp_sub_count <- length(imp_sub$Nrep)
#   
#  tot <- coggan_pursuit %>%
#     filter(Nrep == i)
#   
#  tot_count <- length(tot$Nrep)
#   
#   percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
#   
#   cumulative_percent <- c(cumulative_percent, percent_imp)
#   
# }
# 
# pursuit <- data.frame(Profile = "pursuiter",
#                      nrep = nrep,
#                      cumulative_percent = cumulative_percent)
# 

#time trialist
coggan_tt <- coggan %>%
  filter(profil == "time-trialist")


cumulative_percent <- c()
for (i in nrep){
  imp_sub <- coggan_tt %>%
    filter(Nrep == i,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_tt %>%
    filter(Nrep == i)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

tt <- data.frame(Profile = "time-trialist",
                     nrep = nrep,
                     cumulative_percent = cumulative_percent)

#all around

coggan_aa <- coggan %>%
  filter(profil == "all around")

cumulative_percent <- c()
for (i in nrep){
  imp_sub <- coggan_aa %>%
    filter(Nrep == i,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_aa %>%
    filter(Nrep == i)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

aa <- data.frame(Profile = "all around",
                     nrep = nrep,
                     cumulative_percent = cumulative_percent)

#Joindre les 4 profils ensemble

coggan_cumu <- bind_rows(sprint,  tt, aa)

#renommer les facteurs
coggan_cumu$Profile <- factor(coggan_cumu$Profile, levels = c("time-trialist", "all around",  'sprinter'), labels = c("Time-trialist",  "All rounder", "Sprinter"))

#définir le type de ligne
linetype <- c()
for(i in 1:length(coggan_cumu$Profile)){

 if(coggan_cumu$Profile[i] == "Sprinter"){t <- "solid"}
if(coggan_cumu$Profile[i] == "Time-trialist"){t <- "dotted"}
if(coggan_cumu$Profile[i] == "All rounder"){t <- "twodash"}
linetype <- c(linetype, t)
}

linetype <- data.frame(linetype = linetype)

coggan_cumu <- bind_cols(coggan_cumu, linetype)

#graph
gcnrep <- ggplot(data = coggan_cumu, aes(x= nrep, y = cumulative_percent))+geom_line(aes(linetype = Profile))+xlab("Number of repetitions") + ylab("% impossible sessions")+theme_classic()+ scale_x_continuous( limits = c(min_coggan, max_coggan), breaks = seq(0, 20, 2)) +
   scale_linetype_manual(values = unique(coggan_cumu$linetype))+
  geom_hline(yintercept=30, linetype="solid", color = "blue", size = 0.5)

```

Nrep Skiba

```{r}

#valeur minimale skiba

min_skiba <- min(skiba$Nrep)

#Valeur maximale skiba
max_skiba <- max(skiba$Nrep)

#vecteur d'intensités possible en pourcentage de la PAM

nrep <- seq(2, 20, 1)

#Isoler un profil et calculer le nombre de séances pour une valeur égale ou supérieure en intensité

#Sprinter

skiba_sprint <- skiba %>%
  filter(profil == "sprinter")


cumulative_percent <- c()
for (i in nrep){
  imp_sub <- skiba_sprint %>%
    filter(Nrep == i,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_sprint %>%
    filter(Nrep == i)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

sprint <- data.frame(Profile = "sprinter",
                     nrep = nrep,
                     cumulative_percent = cumulative_percent)

#Pursuiter

# skiba_pursuit <- skiba %>%
#   filter(profil == "pursuiter")
# 
# 
# cumulative_percent <- c()
# for (i in nrep){
#   imp_sub <- skiba_pursuit %>%
#     filter(Nrep == i,
#            percent_power_max > 100)
#   
#   imp_sub_count <- length(imp_sub$Nrep)
#   
#  tot <- skiba_pursuit %>%
#     filter(Nrep == i)
#   
#  tot_count <- length(tot$Nrep)
#   
#   percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
#   
#   cumulative_percent <- c(cumulative_percent, percent_imp)
#   
# }
# 
# pursuit <- data.frame(Profile = "pursuiter",
#                      nrep = nrep,
#                      cumulative_percent = cumulative_percent)
# 

#time trialist
skiba_tt <- skiba %>%
  filter(profil == "time trialist")


cumulative_percent <- c()
for (i in nrep){
  imp_sub <- skiba_tt %>%
    filter(Nrep == i,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_tt %>%
    filter(Nrep == i)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

tt <- data.frame(Profile = "time-trialist",
                     nrep = nrep,
                     cumulative_percent = cumulative_percent)

#all around

skiba_aa <- skiba %>%
  filter(profil == "all around")

cumulative_percent <- c()
for (i in nrep){
  imp_sub <- skiba_aa %>%
    filter(Nrep == i,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_aa %>%
    filter(Nrep == i)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 100, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

aa <- data.frame(Profile = "all around",
                     nrep = nrep,
                     cumulative_percent = cumulative_percent)

#Joindre les 4 profils ensemble

skiba_cumu <- bind_rows(sprint, tt, aa)

#renommer les facteurs
skiba_cumu$Profile <- factor(skiba_cumu$Profile,levels = c("time-trialist", "all around",  'sprinter'), labels = c("Time-trialist",  "All rounder", "Sprinter"))

#définir le type de ligne
linetype <- c()
for(i in 1:length(skiba_cumu$Profile)){

 if(skiba_cumu$Profile[i] == "Sprinter"){t <- "solid"}
if(skiba_cumu$Profile[i] == "Time-trialist"){t <- "dotted"}
if(skiba_cumu$Profile[i] == "All rounder"){t <- "twodash"}
linetype <- c(linetype, t)
}

linetype <- data.frame(linetype = linetype)

skiba_cumu <- bind_cols(skiba_cumu, linetype)

#graph

gsnrep <- ggplot(data = skiba_cumu, aes(x= nrep, y = cumulative_percent))+geom_line(aes(linetype = Profile))+xlab("Number of repetitions") + ylab("% impossible sessions")+theme_classic()+
  scale_x_continuous( limits = c(min_skiba, max_skiba), breaks = seq(0, 20, 2)) +
   scale_linetype_manual(values = unique(skiba_cumu$linetype))+
  geom_hline(yintercept=30, linetype="solid", color = "blue", size = 0.5)

```

Temps total cumulé à intensité

```{r}
#valeur minimale Coggan

min_coggan <- min(coggan$cumul_time)

#Valeur maximale Coggan
max_coggan <- max(coggan$cumul_time)

#vecteur d'intensités possible en pourcentage de la PAM

c_time <- seq(0, 4800, 15)

#Isoler un profil et calculer le nombre de séances pour une valeur égale ou supérieure en intensité

#Sprinter

coggan_sprint <- coggan %>%
  filter(profil == "sprinter")


cumulative_percent <- c()
for (i in c_time){
  imp_sub <- coggan_sprint %>%
    filter(cumul_time > i,
           cumul_time <= i+100,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_sprint %>%
    filter(cumul_time > i,
           cumul_time <= i+100)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

sprint <- data.frame(Profile = "sprinter",
                     c_time = c_time,
                     cumulative_percent = cumulative_percent)

#Pursuiter

# coggan_pursuit <- coggan %>%
#   filter(profil == "pursuiter")
# 
# 
# cumulative_percent <- c()
# for (i in c_time){
#   imp_sub <- coggan_pursuit %>%
#     filter(cumul_time > i,
#            cumul_time <= i+100,
#            percent_power_max > 100)
#   
#   imp_sub_count <- length(imp_sub$Nrep)
#   
#  tot <- coggan_pursuit %>%
#     filter(cumul_time > i,
#            cumul_time <= i+100)
#   
#  tot_count <- length(tot$Nrep)
#   
#   percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
#   
#   cumulative_percent <- c(cumulative_percent, percent_imp)
#   
# }
# 
# pursuit <- data.frame(Profile = "pursuiter",
#                      c_time = c_time,
#                      cumulative_percent = cumulative_percent)


#time trialist
coggan_tt <- coggan %>%
  filter(profil == "time-trialist")


cumulative_percent <- c()
for (i in c_time){
  imp_sub <- coggan_tt %>%
    filter(cumul_time > i,
           cumul_time <= i+100,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_tt %>%
    filter(cumul_time > i,
           cumul_time <= i+100)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

tt <- data.frame(Profile = "time-trialist",
                     c_time = c_time,
                     cumulative_percent = cumulative_percent)

#all around

coggan_aa <- coggan %>%
  filter(profil == "all around")

cumulative_percent <- c()
for (i in c_time){
  imp_sub <- coggan_aa %>%
    filter(cumul_time > i,
           cumul_time <= i+100,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_aa %>%
    filter(cumul_time > i,
           cumul_time <= i+100)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

aa <- data.frame(Profile = "all around",
                     c_time = c_time,
                     cumulative_percent = cumulative_percent)

#Joindre les 4 profils ensemble

coggan_cumu <- bind_rows(sprint,  tt, aa)

#renommer les facteurs
coggan_cumu$Profile <- factor(coggan_cumu$Profile, levels = c("time-trialist", "all around",  'sprinter'), labels = c("Time-trialist",  "All rounder", "Sprinter"))

#définir le type de ligne
linetype <- c()
for(i in 1:length(coggan_cumu$Profile)){

 if(coggan_cumu$Profile[i] == "Sprinter"){t <- "solid"}
if(coggan_cumu$Profile[i] == "Time-trialist"){t <- "dotted"}
if(coggan_cumu$Profile[i] == "All rounder"){t <- "twodash"}
linetype <- c(linetype, t)
}

linetype <- data.frame(linetype = linetype)

coggan_cumu <- bind_cols(coggan_cumu, linetype)


gctarget <- ggplot(data = coggan_cumu, aes(x= c_time, y = cumulative_percent))+geom_line(aes(linetype = Profile))+xlab("Total time at target intensity (s)") + ylab("% impossible sessions")+theme_classic()+
  scale_x_continuous( limits = c(min_coggan, 300), breaks = seq(0, 300, 30)) +
   scale_linetype_manual(values = unique(coggan_cumu$linetype))+
  geom_hline(yintercept=30, linetype="solid", color = "blue", size = 0.5)

```

Temps total cumulé à intensité

```{r}
#valeur minimale skiba

min_skiba <- min(skiba$cumul_time)

#Valeur maximale skiba
max_skiba <- max(skiba$cumul_time)

#vecteur d'intensités possible en pourcentage de la PAM

c_time <- seq(0, 4800, 80)

#Isoler un profil et calculer le nombre de séances pour une valeur égale ou supérieure en intensité

#Sprinter

skiba_sprint <- skiba %>%
  filter(profil == "sprinter")


cumulative_percent <- c()
for (i in c_time){
  imp_sub <- skiba_sprint %>%
    filter(cumul_time > i,
           cumul_time <= i+130,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_sprint %>%
    filter(cumul_time > i,
           cumul_time <= i+130)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

sprint <- data.frame(Profile = "sprinter",
                     c_time = c_time,
                     cumulative_percent = cumulative_percent)

#Pursuiter

# skiba_pursuit <- skiba %>%
#   filter(profil == "pursuiter")
# 
# 
# cumulative_percent <- c()
# for (i in c_time){
#   imp_sub <- skiba_pursuit %>%
#     filter(cumul_time > i,
#            cumul_time <= i+100,
#            percent_power_max > 100)
#   
#   imp_sub_count <- length(imp_sub$Nrep)
#   
#  tot <- skiba_pursuit %>%
#     filter(cumul_time > i,
#            cumul_time <= i+100)
#   
#  tot_count <- length(tot$Nrep)
#   
#   percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
#   
#   cumulative_percent <- c(cumulative_percent, percent_imp)
#   
# }
# 
# pursuit <- data.frame(Profile = "pursuiter",
#                      c_time = c_time,
#                      cumulative_percent = cumulative_percent)
# 

#time trialist
skiba_tt <- skiba %>%
  filter(profil == "time trialist")


cumulative_percent <- c()
for (i in c_time){
  imp_sub <- skiba_tt %>%
    filter(cumul_time > i,
           cumul_time <= i+130,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_tt %>%
    filter(cumul_time > i,
           cumul_time <= i+130)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

tt <- data.frame(Profile = "time-trialist",
                     c_time = c_time,
                     cumulative_percent = cumulative_percent)

#all around

skiba_aa <- skiba %>%
  filter(profil == "all around")

cumulative_percent <- c()
for (i in c_time){
  imp_sub <- skiba_aa %>%
    filter(cumul_time > i,
           cumul_time <= i+130,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_aa %>%
    filter(cumul_time > i,
           cumul_time <= i+130)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

aa <- data.frame(Profile = "all around",
                     c_time = c_time,
                     cumulative_percent = cumulative_percent)

#Joindre les 4 profils ensemble

skiba_cumu <- bind_rows(sprint,  tt, aa)

#renommer les facteurs
skiba_cumu$Profile <- factor(skiba_cumu$Profile, levels = c("time-trialist", "all around",  'sprinter'), labels = c("Time-trialist",  "All rounder", "Sprinter"))

#définir le type de ligne
linetype <- c()
for(i in 1:length(skiba_cumu$Profile)){

 if(skiba_cumu$Profile[i] == "Sprinter"){t <- "solid"}
if(skiba_cumu$Profile[i] == "Time-trialist"){t <- "dotted"}
if(skiba_cumu$Profile[i] == "All rounder"){t <- "twodash"}
linetype <- c(linetype, t)
}

linetype <- data.frame(linetype = linetype)

skiba_cumu <- bind_cols(skiba_cumu, linetype)

#graph

gstarget <- ggplot(data = skiba_cumu, aes(x= c_time, y = cumulative_percent))+geom_line(aes(linetype = Profile))+xlab("Total time at target intensity (s)") + ylab("% impossible sessions")+theme_classic()+ 
  scale_x_continuous( limits = c(min_skiba, 2100), breaks = seq(0, 2100, 240)) +
   scale_linetype_manual(values = unique(skiba_cumu$linetype))+
  geom_hline(yintercept=30, linetype="solid", color = "blue", size = 0.5)

```

Durée du repos Coggan

```{r}
#valeur minimale Coggan

min_coggan <- min(coggan$rest)

#Valeur maximale Coggan
max_coggan <- max(coggan$rest)

#vecteur d'intensités possible en pourcentage de la PAM

rest <- seq(15, 300, 15)

#Isoler un profil et calculer le nombre de séances pour une valeur égale ou supérieure en intensité

#Sprinter

coggan_sprint <- coggan %>%
  filter(profil == "sprinter")


cumulative_percent <- c()
for (i in rest){
  imp_sub <- coggan_sprint %>%
    filter(
           rest >= i,
           rest < i +16,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_sprint %>%
    filter(rest >= i, 
            rest < i +16)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

sprint <- data.frame(Profile = "sprinter",
                    rest = rest,
                     cumulative_percent = cumulative_percent)

#Pursuiter

# coggan_pursuit <- coggan %>%
#   filter(profil == "pursuiter")
# 
# 
# cumulative_percent <- c()
# for (i in rest){
#   imp_sub <- coggan_pursuit %>%
#     filter(rest == i,
#            percent_power_max > 100)
#   
#   imp_sub_count <- length(imp_sub$Nrep)
#   
#  tot <- coggan_pursuit %>%
#     filter(rest == i)
#   
#  tot_count <- length(tot$Nrep)
#   
#   percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
#   
#   cumulative_percent <- c(cumulative_percent, percent_imp)
#   
# }
# 
# pursuit <- data.frame(Profile = "pursuiter",
#                      rest = rest,
#                      cumulative_percent = cumulative_percent)
# 

#time trialist
coggan_tt <- coggan %>%
  filter(profil == "time-trialist")


cumulative_percent <- c()
for (i in rest){
  imp_sub <- coggan_tt %>%
    filter(rest >= i,
            rest < i +16,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_tt %>%
    filter(rest >= i,
            rest < i +16)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

tt <- data.frame(Profile = "time-trialist",
                     rest = rest,
                     cumulative_percent = cumulative_percent)

#all around

coggan_aa <- coggan %>%
  filter(profil == "all around")

cumulative_percent <- c()
for (i in rest){
  imp_sub <- coggan_aa %>%
    filter(rest >= i,
            rest < i +16,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- coggan_aa %>%
    filter(rest >= i,
            rest < i +16)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

aa <- data.frame(Profile = "all around",
                     rest = rest,
                     cumulative_percent = cumulative_percent)

#Joindre les 4 profils ensemble

coggan_cumu <- bind_rows(sprint,  tt, aa)

#renommer les facteurs
coggan_cumu$Profile <- factor(coggan_cumu$Profile, levels = c("time-trialist", "all around",  'sprinter'), labels = c("Time-trialist",  "All around", "Sprinter"))

#définir le type de ligne
linetype <- c()
for(i in 1:length(coggan_cumu$Profile)){

 if(coggan_cumu$Profile[i] == "Sprinter"){t <- "solid"}
if(coggan_cumu$Profile[i] == "Time-trialist"){t <- "dotted"}
if(coggan_cumu$Profile[i] == "All around"){t <- "twodash"}
linetype <- c(linetype, t)
}

linetype <- data.frame(linetype = linetype)

coggan_cumu <- bind_cols(coggan_cumu, linetype)

#graph
gcrest <- ggplot(data = coggan_cumu, aes(x= rest, y = cumulative_percent))+geom_line(aes(linetype = Profile))+xlab("Rest duration (s)") + ylab("% impossible sessions")+theme_classic()+
  scale_x_continuous( limits = c(min_coggan, 300), breaks = seq(0, 300, 30)) +
   scale_linetype_manual(values = unique(coggan_cumu$linetype))+
  geom_hline(yintercept=30, linetype="solid", color = "blue", size = 0.5)

```


Durée du repos skiba

```{r}
#valeur minimale skiba

min_skiba <- min(skiba$rest)

#Valeur maximale skiba
max_skiba <- max(skiba$rest)

#vecteur d'intensités possible en pourcentage de la PAM

rest <- seq(15, 300, 15)

#Isoler un profil et calculer le nombre de séances pour une valeur égale ou supérieure en intensité

#Sprinter

skiba_sprint <- skiba %>%
  filter(profil == "sprinter")


cumulative_percent <- c()
for (i in rest){
  imp_sub <- skiba_sprint %>%
    filter(
           rest >= i,
            rest < i +31,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_sprint %>%
    filter(rest >= i,
            rest < i +31)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

sprint <- data.frame(Profile = "sprinter",
                    rest = rest,
                     cumulative_percent = cumulative_percent)

#Pursuiter

# skiba_pursuit <- skiba %>%
#   filter(profil == "pursuiter")
# 
# 
# cumulative_percent <- c()
# for (i in rest){
#   imp_sub <- skiba_pursuit %>%
#     filter(rest == i,
#            percent_power_max > 100)
#   
#   imp_sub_count <- length(imp_sub$Nrep)
#   
#  tot <- skiba_pursuit %>%
#     filter(rest == i)
#   
#  tot_count <- length(tot$Nrep)
#   
#   percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
#   
#   cumulative_percent <- c(cumulative_percent, percent_imp)
#   
# }
# 
# pursuit <- data.frame(Profile = "pursuiter",
#                      rest = rest,
#                      cumulative_percent = cumulative_percent)
# 

#time trialist
skiba_tt <- skiba %>%
  filter(profil == "time trialist")


cumulative_percent <- c()
for (i in rest){
  imp_sub <- skiba_tt %>%
    filter(rest >= i,
            rest < i +31,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_tt %>%
    filter(rest >= i,
            rest < i +31)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

tt <- data.frame(Profile = "time-trialist",
                     rest = rest,
                     cumulative_percent = cumulative_percent)

#all around

skiba_aa <- skiba %>%
  filter(profil == "all around")

cumulative_percent <- c()
for (i in rest){
  imp_sub <- skiba_aa %>%
    filter(rest >= i,
            rest < i +31,
           percent_power_max > 100)
  
  imp_sub_count <- length(imp_sub$Nrep)
  
 tot <- skiba_aa %>%
    filter(rest >= i,
            rest < i +31)
  
 tot_count <- length(tot$Nrep)
  
  percent_imp <- ifelse(tot_count == 0, 0, imp_sub_count/tot_count *100)   
  
  cumulative_percent <- c(cumulative_percent, percent_imp)
  
}

aa <- data.frame(Profile = "all around",
                     rest = rest,
                     cumulative_percent = cumulative_percent)

#Joindre les 4 profils ensemble

skiba_cumu <- bind_rows(sprint,  tt, aa)

#renommer les facteurs
skiba_cumu$Profile <- factor(skiba_cumu$Profile, levels = c("time-trialist", "all around",  'sprinter'), labels = c("Time-trialist",  "All rounder", "Sprinter"))

#définir le type de ligne
linetype <- c()
for(i in 1:length(skiba_cumu$Profile)){

 if(skiba_cumu$Profile[i] == "Sprinter"){t <- "solid"}
if(skiba_cumu$Profile[i] == "Time-trialist"){t <- "dotted"}
if(skiba_cumu$Profile[i] == "All rounder"){t <- "twodash"}
linetype <- c(linetype, t)
}

linetype <- data.frame(linetype = linetype)

skiba_cumu <- bind_cols(skiba_cumu, linetype)

#graph

gsrest <- ggplot(data = skiba_cumu, aes(x= rest, y = cumulative_percent))+geom_line(aes(linetype = Profile))+xlab("Rest duration (s)") + ylab("% impossible sessions")+theme_classic()+
  scale_x_continuous( limits = c(min_skiba, 300), breaks = seq(0, 300, 30))+
   scale_linetype_manual(values = unique(skiba_cumu$linetype))+
  geom_hline(yintercept=30, linetype="solid", color = "blue", size = 0.5)

```



Joindre les graphiques de Coggan ensemble

```{r}
library(gridExtra)
library(ggplot2)
library(cowplot)


 prow_coggan <- plot_grid(gci + theme(legend.position="none") ,
                   gcint + theme(legend.key.size = unit(0.4, "cm")),
                   gctarget + theme(legend.position="none"),
                   gcrest + theme(legend.position="none"),
          labels = c('A', 'B', 'C', 'D'),         
          align = "vh", 
          nrow = 2,
          ncol = 2, 
          rel_heights = c(1/2, 1/2))

ggsave(prow_coggan, file="Graphs/percent_imp_coggan_3_profiles.png")

```

Joindre les graphiques de Skiba ensemble

```{r}
library(gridExtra)
library(ggplot2)
library(cowplot)


 prow_skiba <- plot_grid(gsi + theme(legend.position="none") ,
                   gsint + theme(legend.key.size = unit(0.4, "cm")),
                   gstarget + theme(legend.position="none"),
                   gsrest + theme(legend.position="none"),
          labels = c('A', 'B', 'C', 'D'),         
          align = "vh", 
          nrow = 2,
          ncol = 2, 
          rel_heights = c(1/2, 1/2))

ggsave(prow_skiba, file="Graphs/percent_imp_skiba_3_profiles.png")

```


